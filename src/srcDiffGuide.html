<?xml version="1.0" encoding="utf-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xml:lang="en" lang="en">
  <head>

    <title>srcDiff Guide</title>

  </head>
  <body>

    <h1>srcDiff Guide</h1>

    <p>This is a general guide to using srcdiff tool and related
    srcDiff format.</p>

    <p>The srcDiff format is an extension to srcML.  The namespace is:
</p>
<pre>
http://www.sdml.info/srcDiff
</pre>

    <p>The default prefix is <code>diff</code>.  The namespace
    primarily consists of the elements:
</p>

    <ul>
      <li><code>&lt;diff:insert</code>&gt; Marks inserted code</li>
      <li><code>&lt;diff:delete</code>&gt; Marks deleted code</li>
    </ul>

    <p>
      These elements are used to wrap the changes around the srcML
      elements.  Code that is not contained in these elements is
      common to both versions.  Due to well-formedness requirements of
      XML, another element <code>&lt;diff:common</code>&gt; can be
      nested in <code>&lt;diff:insert</code>&gt;
      or <code>&lt;diff:delete</code>&gt;.
    </p>

    <p>
      The format consists of both versions of the document:
</p>

    <ul>
      <li>First version: contained in no diff:* element, or directly in
      a <code>&lt;diff:common&gt;</code>
      or <code>&lt;diff:delete&gt;</code></li>
   <li>Second version:  contained in no diff:* element, or directly in a <code>&lt;diff:common&gt;</code> or <code>&lt;diff:insert&gt;</code></li>
    </ul>

    <p>
      Content that is not inside a diff:* element is considered to be
      common.  This means that a document with no changes will 
      contain any no diff:* elements, but only have the namespace declared.
    </p>

<h3>Generating srcDiff</h3>

<p>The srcDiff format is generated by the <code>srcdiff</code> tool.
  For example, to convert two versions of the same file to the srcdiff
  format:
</p>

<pre>
srcdiff.exe v1\main.cpp v2\main.cpp -o main.cpp.xml
</pre>

<p>Note that the srcdiff tool internally takes care of the conversion
  to srcML.
</p>

<p>
In addition to conversion of two versions of the same file, the
srcdiff tool can also generate a srcDiff archive similar to a srcML
archive.  This can be done by providing pairs of multiple files as
arguments, or by creating a file list.  The file list is in the
following form:
</p>

<pre>
v1\main.cpp|v2\main.cpp
v1\f.hpp|v2\f.hpp
v1\f.cpp|v2\f.cpp
</pre>

<p>Each pair of files is listed on a single line.  The two filenames
  are separated by a vertical bar '|'.
</p>

<p>
The code for the input options to srcdiff are taken from the code in
src2srcml, and we expect to eventually be able to handle all the input variations
of src2srcml in the srcdiff tool, e.g., input from tar archives.  This
would allow someone to specify two tar files consisting of two
different releases of a project.
</p>

  </body>
</html>
