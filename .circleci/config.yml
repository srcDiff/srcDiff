version: 2
jobs:
    build:
      docker:
        - image: srcml/srcdiff_testing
      steps:
        - checkout
        - run: apt-get update
        - run: apt-get install -y git ssh
        - run: git submodule update --init --recursive
        - run: mkdir build
        - run: cd build && cmake -DCMAKE_BUILD_TYPE=Release ..
        - run: cd build && make
        - run: ln -s build/bin bin
        - run: cd test && ./test_suite.py
